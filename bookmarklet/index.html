<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Remove Elements Bookmarklet</title>
    <link rel="stylesheet" href="./prism/prism.css" />
    <link rel="stylesheet" href="writeup.css" />
  </head>
  <body>
    <h1>Remove Elements Bookmarklet</h1>
    <p>
      Drag and Drop the link to your bookmarks toolbar:
      <a
        href="javascript: (function () {
					document.body.style.paddingTop = '20px';
					var removedElements = [];
					var removalActive = true;
					var currentHighlightedElement;
				
			
					function createButton(text, callback) {
		
						var btn = document.createElement('button');
						btn.innerHTML = text;
						btn.style.position = 'fixed';
						btn.style.top = '10px';
						btn.style.zIndex = '999999';
						btn.style.color = 'Blue';
						btn.style.backgroundColor = 'Orange';
						btn.style.border = '1px solid black';
						btn.style.padding = '5px';
						btn.style.marginRight = '10px';
						btn.onclick = callback;
						document.body.appendChild(btn);
						return btn;
					}
				
			
					var undoButton = createButton('Undo', function () {

						if (removedElements.length) {
							var lastElement = removedElements.pop();
							lastElement.parent.insertBefore(
								lastElement.node,
								lastElement.nextSibling
							);
						}
					});
				

					var endButton = createButton('End', function () {
			
						removalActive = false;
						undoButton.remove();
						endButton.remove();
						resetButton.remove();
						document.removeEventListener('mousemove', highlightElement);
					});

					var resetButton = createButton('Reset', function () {
						while (removedElements.length) {
							var restoredElement = removedElements.pop();
							restoredElement.parent.insertBefore(
								restoredElement.node,
								restoredElement.nextSibling
							);
						}
					});
				
					endButton.style.left = 'calc(10px + ' + undoButton.offsetWidth + 'px)';
					resetButton.style.left = 'calc(20px + ' + (undoButton.offsetWidth + endButton.offsetWidth) + 'px)';
				
					function highlightElement(event) {
						if (currentHighlightedElement) {
							currentHighlightedElement.style.outline = '';
						}
						var element = document.elementFromPoint(event.clientX, event.clientY);
						if (element) {
							currentHighlightedElement = element;
							currentHighlightedElement.style.outline = '2px solid red';
						}
					}
				
					document.addEventListener('mousemove', highlightElement);
				
					document.addEventListener('click', function (event) {
						if (!removalActive) return;
						event.preventDefault();
						event.stopPropagation();
				
					
						if (currentHighlightedElement) {
							if (currentHighlightedElement.innerHTML === 'Undo' ||  currentHighlightedElement.innerHTML === 'Reset') {
								return true;
							}
							currentHighlightedElement.style.outline = ''; 
							var removedElement = {
								node: currentHighlightedElement,
								parent: currentHighlightedElement.parentNode,
								nextSibling: currentHighlightedElement.nextSibling,
							};
					
							removedElements.push(removedElement);
							currentHighlightedElement.remove();
							currentHighlightedElement = null;
						}
					});
				
	
					document.addEventListener('keyup', function (event) {
						if (event.key === 'Escape') {
							removalActive = false;
							undoButton.remove();
							endButton.remove();
							resetButton.remove();
							document.removeEventListener('mousemove', highlightElement);
						}
					});
				})();
				"
        >Remove_Bookmark</a
      >
    </p>
    <h2>Bookmarklet Code</h2>
    <pre><code class="language-javascript">
			<!-- display Bookmarklet Code  -->
			javascript: (function () {
				document.body.style.paddingTop = "20px";
				var removedElements = [];
				var removalActive = true;
				var currentHighlightedElement;
			
				// Create button at the top corner of the page
				function createButton(text, callback) {
					// alert('do you come here!')
					var btn = document.createElement("button");
					btn.innerHTML = text;
					btn.style.position = "fixed";
					btn.style.top = "10px";
					btn.style.zIndex = "999999";
					btn.style.color = "Blue";
					btn.style.backgroundColor = "Orange";
					btn.style.border = "1px solid black";
					btn.style.padding = "5px";
					btn.style.marginRight = "10px";
					btn.onclick = callback;
					document.body.appendChild(btn);
					return btn;
				}
			
				// undo call back function
				var undoButton = createButton("Undo", function () {
					// alert('undo button clicked '');
					if (removedElements.length) {
						var lastElement = removedElements.pop();
						lastElement.parent.insertBefore(
							lastElement.node,
							lastElement.nextSibling
						);
					}
				});
			
				// End button remove all buttons and mouseover effect
				var endButton = createButton("End", function () {
					// alert('end Button clicked');
					removalActive = false;
					undoButton.remove();
					endButton.remove();
					resetButton.remove();
					document.removeEventListener("mousemove", highlightElement);
				});
			
				// Reset button to restore all removed elements
				var resetButton = createButton("Reset", function () {
					while (removedElements.length) {
						var restoredElement = removedElements.pop();
						restoredElement.parent.insertBefore(
							restoredElement.node,
							restoredElement.nextSibling
						);
					}
				});
			
				endButton.style.left = "calc(10px + " + undoButton.offsetWidth + "px)";
				resetButton.style.left =
					"calc(10px + " + (undoButton.offsetWidth + endButton.offsetWidth) + "px)";
			
				function highlightElement(event) {
					if (currentHighlightedElement) {
						currentHighlightedElement.style.outline = "";
					}
					var element = document.elementFromPoint(event.clientX, event.clientY);
					if (element) {
						currentHighlightedElement = element;
						currentHighlightedElement.style.outline = "2px solid red";
					}
				}
			
				document.addEventListener("mousemove", highlightElement);
			
				document.addEventListener("click", function (event) {
					if (!removalActive) return;
					event.preventDefault();
					event.stopPropagation();
			
					// Exception for undo button not to be highlighted and removed when clicked
					if (currentHighlightedElement) {
						if (
							currentHighlightedElement.innerHTML === "Undo" ||
							currentHighlightedElement.innerHTML === "Reset"
						) {
							return true;
						}
						currentHighlightedElement.style.outline = ""; // remove the highlights before added to the removedElement
						var removedElement = {
							node: currentHighlightedElement,
							parent: currentHighlightedElement.parentNode,
							nextSibling: currentHighlightedElement.nextSibling,
						};
						// node.style.outline.remove();
						removedElements.push(removedElement);
						currentHighlightedElement.remove();
						currentHighlightedElement = null;
					}
				});
			
				// when Escape key is pressed it exists the bokmarklet mode
				document.addEventListener("keyup", function (event) {
					if (event.key === "Escape") {
						removalActive = false;
						undoButton.remove();
						endButton.remove();
						resetButton.remove();
						document.removeEventListener("mousemove", highlightElement);
					}
				});
			})();
			
    </code></pre>
    <h2>5-Tested Websites</h2>
    <ul>
      <li>
        <a href="https://www.nytimes.com/" target="_blank"
          >The New York Times</a
        >
      </li>
      <li><a href="https://web.mit.edu/" target="_blank">MIT</a></li>
      <li>
        <a href="https://www.w3schools.com/" target="_blank">W3Schools</a>
      </li>
      <li>
        <a href="https://www.stackoverflow.com/" target="_blank"
          >Stack Overflow</a
        >
      </li>
      <li>
        <a href="https://www.wikipedia.org/" target="_blank">Wikipedia</a>
      </li>
      <li>
        <a href="https://www.npr.org/" target="_blank">Npr Radio Station</a>
      </li>
    </ul>
    <script src="./prism/prism.js"></script>
  </body>
</html>
